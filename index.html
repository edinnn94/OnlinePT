<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OnlinePT</title>
  <style>
    body {
      font-family: monospace, monospace;
      background: #f0f0f0;
      max-width: 600px;
      margin: 20px auto;
      padding: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 0 10px #ccc;
    if (i >= text.length && done) done();
    #greeting {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    if (i >= text.length && done) done();
    #greeting img {
      width: 50px;
      height: 50px;
      margin-right: 12px;
    if (i >= text.length && done) done();
    button {
      font-family: monospace;
      font-size: 1.1em;
      padding: 10px 16px;
      margin: 8px 5px 0 0;
      border-radius: 5px;
      border: 1px solid #333;
      background: white;
      cursor: pointer;
    if (i >= text.length && done) done();
    button:hover {
      background: #eee;
    if (i >= text.length && done) done();
    #chatbotText {
      min-height: 60px;
      white-space: pre-wrap;
      border-bottom: 2px solid #333;
      padding-bottom: 8px;
      margin-bottom: 12px;
      font-size: 1.1em;
    if (i >= text.length && done) done();
    input[type="text"] {
      width: 100%;
      font-family: monospace;
      font-size: 1.1em;
      padding: 8px;
      margin: 6px 0 12px 0;
      border: 1px solid #ccc;
      border-radius: 4px;
    if (i >= text.length && done) done();
    #navButtons {
      margin-top: 10px;
    if (i >= text.length && done) done();
    .hidden {
      display: none;
    if (i >= text.length && done) done();
  
    #mainMenu button {
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.6s ease, transform 0.6s ease;
    if (i >= text.length && done) done();
    #mainMenu.show-buttons button {
      opacity: 1;
      transform: translateY(0);
    if (i >= text.length && done) done();
    </style>
</head>
<body>

<div id="mainMenu">
  <div id="greeting">
    <img src="robot-logo.png" alt="Robot Logo" />
    <p id="introText">Hej, jag är din personliga AI-tränare. Vad kan jag hjälpa dig med?</p>
  </div>
  <button data-section="training">Personlig träningsplan</button>
  <button data-section="nutrition">Kostplan</button>
  <button data-section="other">Annat</button>
</div>

<div id="chatSection" class="hidden">
  <div id="chatbotText"></div>
  <input type="text" id="answerInput" autocomplete="off" />
  <div id="navButtons">
    <button id="backBtn">← Tillbaka</button>
    <button id="nextBtn" disabled>→ Nästa</button>
  </div>
</div>

<script>
  const questions = {
    training: [
      "Vilket är ditt träningsmål? (exempelvis styrketräning, kondition, rörlighet etc)",
      "Hur många gånger i veckan vill du träna?",
      "Vill du träna hemma eller på gym?"
    ],
    nutrition: [
      "Vad kul! Men först behöver jag lite mer information om dig:\nAnge din längd (cm), vikt (kg), ålder och aktivitetsnivå (t.ex. låg, måttlig, intensiv), separerade med kommatecken.",
      "Hur många måltider vill du äta per dag?",
      "Vill du fokusera på något särskilt? (t.ex. viktnedgång, muskelökning, allmän hälsa)"
    ],
    other: [
      "Vad behöver du hjälp med? Vad undrar du över?"
    ]
  if (i >= text.length && done) done();;

  let section = 'main';
  let questionIndex = 0;
  let answers = {
    training: [],
    nutrition: [],
    other: []
  if (i >= text.length && done) done();;

  const mainMenu = document.getElementById('mainMenu');
  const chatSection = document.getElementById('chatSection');
  const chatbotText = document.getElementById('chatbotText');
  const answerInput = document.getElementById('answerInput');
  const nextBtn = document.getElementById('nextBtn');
  const backBtn = document.getElementById('backBtn');

  function typeWriter(text, i = 0, callback) {
    if (i < text.length) {
      chatbotText.textContent += text.charAt(i);
      setTimeout(() => typeWriter(text, i + 1, callback), 30);
    if (i >= text.length && done) done(); else {
      if (callback) callback();
    if (i >= text.length && done) done();
  if (i >= text.length && done) done();

  function showQuestion() {
    chatbotText.textContent = "";
    answerInput.value = "";
    nextBtn.disabled = true;
    const q = questions[section][questionIndex];
    typeWriter(q, 0, () => {
      if (answers[section][questionIndex]) {
        answerInput.value = answers[section][questionIndex];
        nextBtn.disabled = false;
      if (i >= text.length && done) done();
      answerInput.focus();
    if (i >= text.length && done) done(););
  if (i >= text.length && done) done();

  function updateView() {
    if (section === 'main') {
      mainMenu.classList.remove('hidden');
      chatSection.classList.add('hidden');
    if (i >= text.length && done) done(); else {
      mainMenu.classList.add('hidden');
      chatSection.classList.remove('hidden');
      showQuestion();
    if (i >= text.length && done) done();
  if (i >= text.length && done) done();

  function goNext() {
    const val = answerInput.value.trim();
    if (!val) return;
    answers[section][questionIndex] = val;

    if (questionIndex < questions[section].length - 1) {
      questionIndex++;
    if (i >= text.length && done) done(); else {
      alert("Tack för dina svar! Du kan gå tillbaka till menyn och välja något annat.");
      section = 'main';
      questionIndex = 0;
    if (i >= text.length && done) done();
    updateView();
  if (i >= text.length && done) done();

  function goBack() {
    if (section === 'main') return;

    if (questionIndex > 0) {
      questionIndex--;
    if (i >= text.length && done) done(); else {
      section = 'main';
      questionIndex = 0;
    if (i >= text.length && done) done();
    updateView();
  if (i >= text.length && done) done();

  document.querySelectorAll('#mainMenu button').forEach(btn => {
    btn.addEventListener('click', () => {
      section = btn.dataset.section;
      questionIndex = 0;
      updateView();
    if (i >= text.length && done) done(););
  if (i >= text.length && done) done(););

  nextBtn.addEventListener('click', goNext);
  backBtn.addEventListener('click', goBack);
  answerInput.addEventListener('input', () => {
    nextBtn.disabled = answerInput.value.trim() === '';
  if (i >= text.length && done) done(););

  function typeIntro(text, i = 0, done) {
    const introEl = document.getElementById('introText');
    introEl.textContent = '';
    function typeChar() {
      if (i === 0) introEl.textContent = '';
      if (i < text.length) {
        introEl.textContent += text.charAt(i);
        i++;
        setTimeout(typeChar, 10);
      if (i >= text.length && done) done();
    if (i >= text.length && done) done();
    typeChar();
  if (i >= text.length && done) done();

  window.addEventListener('DOMContentLoaded', () => {
    const menu = document.getElementById('mainMenu');
    const introEl = document.getElementById('introText');
    if (introEl) {
      const introText = introEl.textContent;
      typeIntro(introText, () => {
        // Visa knappar med animation efter skrivmaskinseffekten
        menu.classList.add('show-buttons');
      if (i >= text.length && done) done(););
    if (i >= text.length && done) done();
  if (i >= text.length && done) done(););
</script>

</body>
</html>